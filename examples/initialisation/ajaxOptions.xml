<?xml version="1.0" encoding="UTF-8" ?>
<dt-example table-type="html" table-class="display nowrap" order="1">

<css lib="datatables searchpanes select"/>

<js lib="jquery datatables searchpanes select">
<![CDATA[

var json = {
  "data": [
    {
      "DT_RowId": "row_32",
      "users": {
        "first_name": "Alexa",
        "last_name": "Wilder",
        "phone": "1-727-307-1997",
        "site": "2"
      },
      "sites": {
        "name": "London"
      }
    },
    {
      "DT_RowId": "row_11",
      "users": {
        "first_name": "Avram",
        "last_name": "Allison",
        "phone": "1-751-507-2640",
        "site": "5"
      },
      "sites": {
        "name": "Singapore"
      }
    },
    {
      "DT_RowId": "row_28",
      "users": {
        "first_name": "Basia",
        "last_name": "Harrell",
        "phone": "1-528-238-4178",
        "site": "4"
      },
      "sites": {
        "name": "New York"
      }
    },
    {
      "DT_RowId": "row_8",
      "users": {
        "first_name": "Bryar",
        "last_name": "Long",
        "phone": "1-918-114-8083",
        "site": "2"
      },
      "sites": {
        "name": "London"
      }
    },
    {
      "DT_RowId": "row_3",
      "users": {
        "first_name": "Cruz",
        "last_name": "Reynolds",
        "phone": "1-776-102-6352",
        "site": "3"
      },
      "sites": {
        "name": "Paris"
      }
    },
    {
      "DT_RowId": "row_30",
      "users": {
        "first_name": "Dexter",
        "last_name": "Burton",
        "phone": "1-275-332-8186",
        "site": "6"
      },
      "sites": {
        "name": "Los Angeles"
      }
    },
    {
      "DT_RowId": "row_6",
      "users": {
        "first_name": "Dustin",
        "last_name": "Rosa",
        "phone": "1-875-919-3188",
        "site": "6"
      },
      "sites": {
        "name": "Los Angeles"
      }
    },
    {
      "DT_RowId": "row_29",
      "users": {
        "first_name": "Hamilton",
        "last_name": "Blackburn",
        "phone": "1-676-857-1423",
        "site": "5"
      },
      "sites": {
        "name": "Singapore"
      }
    },
    {
      "DT_RowId": "row_27",
      "users": {
        "first_name": "Ifeoma",
        "last_name": "Mays",
        "phone": "1-103-883-0962",
        "site": "3"
      },
      "sites": {
        "name": "Paris"
      }
    },
    {
      "DT_RowId": "row_10",
      "users": {
        "first_name": "Indigo",
        "last_name": "Brennan",
        "phone": "1-756-756-8161",
        "site": "4"
      },
      "sites": {
        "name": "New York"
      }
    }
  ],
  "options": {
    "users.site": [
      {
        "label": "Edinburgh",
        "value": "1"
      },
      {
        "label": "London",
        "value": "2"
      },
      {
        "label": "Los Angeles",
        "value": "6"
      },
      {
        "label": "New York",
        "value": "4"
      },
      {
        "label": "Paris",
        "value": "3"
      },
      {
        "label": "Singapore",
        "value": "5"
      }
    ]
  },
  "files": [],
  "searchPanes": {
    "options": {
      "users.first_name": [
        {
          "label": "Alexa",
          "total": "1",
          "value": "Alexa",
          "count": "1"
        },
        {
          "label": "Avram",
          "total": "1",
          "value": "Avram",
          "count": "1"
        },
        {
          "label": "Basia",
          "total": "1",
          "value": "Basia",
          "count": "1"
        },
        {
          "label": "Bryar",
          "total": "1",
          "value": "Bryar",
          "count": "1"
        },
        {
          "label": "Cruz",
          "total": "1",
          "value": "Cruz",
          "count": "1"
        },
        {
          "label": "Dexter",
          "total": "1",
          "value": "Dexter",
          "count": "1"
        },
        {
          "label": "Dustin",
          "total": "1",
          "value": "Dustin",
          "count": "1"
        },
        {
          "label": "Hamilton",
          "total": "1",
          "value": "Hamilton",
          "count": "1"
        },
        {
          "label": "Ifeoma",
          "total": "1",
          "value": "Ifeoma",
          "count": "1"
        },
        {
          "label": "Indigo",
          "total": "1",
          "value": "Indigo",
          "count": "1"
        }
      ],
      "users.last_name": [
        {
          "label": "Allison",
          "total": "1",
          "value": "Allison",
          "count": "1"
        },
        {
          "label": "Blackburn",
          "total": "1",
          "value": "Blackburn",
          "count": "1"
        },
        {
          "label": "Brennan",
          "total": "1",
          "value": "Brennan",
          "count": "1"
        },
        {
          "label": "Burton",
          "total": "1",
          "value": "Burton",
          "count": "1"
        },
        {
          "label": "Harrell",
          "total": "2",
          "value": "Harrell",
          "count": "2"
        },
        {
          "label": "Long",
          "total": "1",
          "value": "Long",
          "count": "1"
        },
        {
          "label": "Mays",
          "total": "1",
          "value": "Mays",
          "count": "1"
        },
        {
          "label": "Reynolds",
          "total": "1",
          "value": "Reynolds",
          "count": "1"
        },
        {
          "label": "Rosa",
          "total": "1",
          "value": "Rosa",
          "count": "1"
        },
        {
          "label": "Wilder",
          "total": "1",
          "value": "Wilder",
          "count": "1"
        }
      ],
      "users.phone": [
        {
          "label": "1-103-883-0962",
          "total": "1",
          "value": "1-103-883-0962",
          "count": "1"
        },
        {
          "label": "1-275-332-8186",
          "total": "1",
          "value": "1-275-332-8186",
          "count": "1"
        },
        {
          "label": "1-528-238-4178",
          "total": "1",
          "value": "1-528-238-4178",
          "count": "1"
        },
        {
          "label": "1-676-857-1423",
          "total": "1",
          "value": "1-676-857-1423",
          "count": "1"
        },
        {
          "label": "1-727-307-1997",
          "total": "1",
          "value": "1-727-307-1997",
          "count": "1"
        },
        {
          "label": "1-751-507-2640",
          "total": "1",
          "value": "1-751-507-2640",
          "count": "1"
        },
        {
          "label": "1-756-756-8161",
          "total": "1",
          "value": "1-756-756-8161",
          "count": "1"
        },
        {
          "label": "1-776-102-6352",
          "total": "1",
          "value": "1-776-102-6352",
          "count": "1"
        },
        {
          "label": "1-875-919-3188",
          "total": "1",
          "value": "1-875-919-3188",
          "count": "1"
        },
        {
          "label": "1-918-114-8083",
          "total": "1",
          "value": "1-918-114-8083",
          "count": "1"
        }
      ],
      "sites.name": [
        {
          "label": "London",
          "total": "2",
          "value": "London",
          "count": "2"
        },
        {
          "label": "Los Angeles",
          "total": "2",
          "value": "Los Angeles",
          "count": "2"
        },
        {
          "label": "New York",
          "total": "2",
          "value": "New York",
          "count": "2"
        },
        {
          "label": "Paris",
          "total": "2",
          "value": "Paris",
          "count": "2"
        },
        {
          "label": "Singapore",
          "total": "2",
          "value": "Singapore",
          "count": "2"
        }
      ]
    }
  },
  "draw": 1,
  "recordsTotal": "36",
  "recordsFiltered": "36",
  "debug": [
    {
      "query": "SELECT COUNT( `users`.`id` ) as `cnt` FROM  `users` LEFT JOIN `sites` ON `sites`.`id` = `users`.`site` ",
      "bindings": []
    },
    {
      "query": "SELECT COUNT( `users`.`id` ) as `cnt` FROM  `users` ",
      "bindings": []
    },
    {
      "query": "SELECT  `users`.`id` as 'users.id', `users`.`first_name` as 'users.first_name', `users`.`last_name` as 'users.last_name', `users`.`phone` as 'users.phone', `users`.`site` as 'users.site', `sites`.`name` as 'sites.name' FROM  `users` LEFT JOIN `sites` ON `sites`.`id` = `users`.`site`  ORDER BY `users`.`first_name`  asc  LIMIT 10",
      "bindings": []
    },
    {
      "query": "SELECT  `users`.`first_name` as 'value', COUNT(*) as count FROM  `users` LEFT JOIN `sites` ON `sites`.`id` = `users`.`site`  GROUP BY users.first_name",
      "bindings": []
    },
    {
      "query": "SELECT  `users`.`first_name` as 'label', `users`.`first_name` as 'value', COUNT(*) as total FROM  `users`  GROUP BY users.first_name",
      "bindings": []
    },
    {
      "query": "SELECT  `users`.`last_name` as 'value', COUNT(*) as count FROM  `users` LEFT JOIN `sites` ON `sites`.`id` = `users`.`site`  GROUP BY users.last_name",
      "bindings": []
    },
    {
      "query": "SELECT  `users`.`last_name` as 'label', `users`.`last_name` as 'value', COUNT(*) as total FROM  `users`  GROUP BY users.last_name",
      "bindings": []
    },
    {
      "query": "SELECT  `phone` as 'value', COUNT(*) as count FROM  `users` LEFT JOIN `sites` ON `sites`.`id` = `users`.`site`  GROUP BY phone",
      "bindings": []
    },
    {
      "query": "SELECT  `phone` as 'label', `phone` as 'value', COUNT(*) as total FROM  `users`  GROUP BY phone",
      "bindings": []
    },
    {
      "query": "SELECT DISTINCT  `id` as 'id', `name` as 'name' FROM  `sites` ",
      "bindings": []
    },
    {
      "query": "SELECT  `sites`.`name` as 'value', COUNT(*) as count FROM  `users` LEFT JOIN `sites` ON `sites`.`id` = `users`.`site`  GROUP BY sites.name",
      "bindings": []
    },
    {
      "query": "SELECT  `sites`.`name` as 'label', `sites`.`name` as 'value', COUNT(*) as total FROM  `users` LEFT JOIN `sites` ON `sites`.`id` = `users`.`site`  GROUP BY sites.name",
      "bindings": []
    }
  ]
};

$(document).ready( function() {
  var table = $('#example').DataTable({
    dom: 'Plfrtip',
    columns: [
        { data: "users.first_name" },
        { data: "users.last_name" },
        { data: "users.phone" },
        { data: "sites.name" }
    ],
    columnDefs: [{
        searchPanes: {
            show: true
        },
        targets: [0, 1, 2, 3]
    }],
    ajax: function(data, success) {
      // Simulate an async action
      setTimeout( function () {
        return success(json);
      }, 500);
    }
  });
} );


]]>
</js>

<title lib="searchPanes">Options from Ajax</title>

<info><![CDATA[

This is the `-init searchPanes`extension for DataTables. This example shows how SearchPanes can be populated via ajax, while using client side processing. The SearchPanes options must be defined in the ajax json data for this to happen, otherwise SearchPanes will just extract the data from the table as usual. The structure of the JSON required is documented [here](https://datatables.net/extensions/searchpanes/serverside#Implementation-details) under the "Returned Data" heading.

It is worth noting that due to the requirements for users to provide accurate data for the SearchPanes options, neither `-init searchPanes.cascadePanes` or `-init searchPanes.viewTotal` are supported using this setup. While it is still possible to enable these options, it is not advised and may lead to unexpected behaviour.

]]></info>

<custom-table>
<table id="example" class="display nowrap" width="100%">
        <thead>
          <tr>
            <th>First name</th>
            <th>Last name</th>
            <th>Phone</th>
            <th>Site</th>
          </tr>
        </thead>
      </table>
</custom-table>
</dt-example>
